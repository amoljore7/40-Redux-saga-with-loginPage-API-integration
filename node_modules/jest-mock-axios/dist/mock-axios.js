"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _synchronousPromise = require("synchronous-promise");

var _Cancel = _interopRequireDefault(require("./cancel/Cancel"));

var _CancelToken = _interopRequireDefault(require("./cancel/CancelToken"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/** a FIFO queue of pending request */
var _pending_requests = [];

var _newReq = function _newReq() {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var method = config.method;
  var url = config.url;
  var data = config.data;

  var promise = _synchronousPromise.SynchronousPromise.unresolved();

  _pending_requests.push({
    config: config,
    data: data,
    method: method,
    promise: promise,
    url: url
  });

  return promise;
};

var _helperReq = function _helperReq(method, url, data, config) {
  var conf = data && config ? config : {};
  return _newReq(_objectSpread({}, conf, {
    data: data,
    method: method,
    url: url
  }));
};

var MockAxios = jest.fn(_newReq); // mocking Axios methods

MockAxios.get = jest.fn(_helperReq.bind(null, "get"));
MockAxios.post = jest.fn(_helperReq.bind(null, "post"));
MockAxios.put = jest.fn(_helperReq.bind(null, "put"));
MockAxios.patch = jest.fn(_helperReq.bind(null, "patch"));
MockAxios["delete"] = jest.fn(_helperReq.bind(null, "delete"));
MockAxios.request = jest.fn(_newReq);
MockAxios.all = jest.fn(function (values) {
  return Promise.all(values);
});
MockAxios.head = jest.fn(_helperReq.bind(null, "head"));
MockAxios.options = jest.fn(_helperReq.bind(null, "options"));
MockAxios.create = jest.fn(function () {
  return MockAxios;
});
MockAxios.interceptors = {
  request: {
    use: jest.fn()
  },
  response: {
    use: jest.fn()
  }
};
MockAxios.defaults = {
  headers: {
    common: []
  }
};

MockAxios.popPromise = function (promise) {
  if (promise) {
    // remove the promise from pending queue
    for (var ix = 0; ix < _pending_requests.length; ix++) {
      var req = _pending_requests[ix];

      if (req.promise === promise) {
        _pending_requests.splice(ix, 1);

        return req.promise;
      }
    }
  } else {
    // take the oldest promise
    var _req = _pending_requests.shift();

    return _req ? _req.promise : void 0;
  }
};

MockAxios.popRequest = function (request) {
  if (request) {
    var ix = _pending_requests.indexOf(request);

    if (ix === -1) {
      return void 0;
    }

    _pending_requests.splice(ix, 1);

    return request;
  } else {
    return _pending_requests.shift();
  }
};
/**
 * Removes an item form the queue, based on it's type
 * @param queueItem
 */


var popQueueItem = function popQueueItem() {
  var queueItem = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
  // first let's pretend the param is a queue item
  var request = MockAxios.popRequest(queueItem);

  if (request) {
    // IF the request was found
    // > set the promise
    return request.promise;
  } else {
    // ELSE maybe the `queueItem` is a promise (legacy mode)
    return MockAxios.popPromise(queueItem);
  }
};

MockAxios.mockResponse = function (response) {
  var queueItem = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
  var silentMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  // replacing missing data with default values
  response = Object.assign({
    config: {},
    data: {},
    headers: {},
    status: 200,
    statusText: "OK"
  }, response);
  var promise = popQueueItem(queueItem);

  if (!promise && !silentMode) {
    throw new Error("No request to respond to!");
  } else if (!promise) {
    return;
  } // resolving the Promise with the given response data


  promise.resolve(response);
};

MockAxios.mockResponseFor = function (criteria, response) {
  var silentMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  if (typeof criteria === "string") {
    criteria = {
      url: criteria
    };
  }

  var queueItem = MockAxios.getReqMatching(criteria);

  if (!queueItem && !silentMode) {
    throw new Error("No request to respond to!");
  } else if (!queueItem) {
    return;
  }

  MockAxios.mockResponse(response, queueItem, silentMode);
};

MockAxios.mockError = function () {
  var error = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var queueItem = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
  var silentMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var promise = popQueueItem(queueItem);

  if (!promise && !silentMode) {
    throw new Error("No request to respond to!");
  } else if (!promise) {
    return;
  } // resolving the Promise with the given response data


  promise.reject(error);
};

MockAxios.lastReqGet = function () {
  return _pending_requests[_pending_requests.length - 1];
};

MockAxios.lastPromiseGet = function () {
  var req = MockAxios.lastReqGet();
  return req ? req.promise : void 0;
};

var _checkCriteria = function _checkCriteria(item, criteria) {
  if (criteria.method !== undefined && criteria.method !== item.method) {
    return false;
  }

  if (criteria.url !== undefined && criteria.url !== item.url) {
    return false;
  }

  return true;
};

MockAxios.getReqMatching = function (criteria) {
  return _pending_requests.slice().reverse() // reverse cloned array to return most recent req
  .find(function (x) {
    return _checkCriteria(x, criteria);
  });
};

MockAxios.getReqByUrl = function (url) {
  return MockAxios.getReqMatching({
    url: url
  });
};

MockAxios.reset = function () {
  // remove all the requests
  _pending_requests.splice(0, _pending_requests.length); // resets all information stored in the mockFn.mock.calls and mockFn.mock.instances arrays


  MockAxios.get.mockClear();
  MockAxios.post.mockClear();
  MockAxios.put.mockClear();
  MockAxios.patch.mockClear();
  MockAxios["delete"].mockClear();
  MockAxios.head.mockClear();
  MockAxios.options.mockClear();
  MockAxios.request.mockClear();
  MockAxios.all.mockClear();
};

MockAxios.Cancel = _Cancel["default"];
MockAxios.CancelToken = _CancelToken["default"];

MockAxios.isCancel = function (u) {
  return !!(u && u.__CANCEL__);
}; // this is a singleton object


var _default = MockAxios;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2xpYi9tb2NrLWF4aW9zLnRzIl0sIm5hbWVzIjpbIl9wZW5kaW5nX3JlcXVlc3RzIiwiX25ld1JlcSIsImNvbmZpZyIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJwcm9taXNlIiwiU3luY2hyb25vdXNQcm9taXNlIiwidW5yZXNvbHZlZCIsInB1c2giLCJfaGVscGVyUmVxIiwiY29uZiIsIk1vY2tBeGlvcyIsImplc3QiLCJmbiIsImdldCIsImJpbmQiLCJwb3N0IiwicHV0IiwicGF0Y2giLCJyZXF1ZXN0IiwiYWxsIiwidmFsdWVzIiwiUHJvbWlzZSIsImhlYWQiLCJvcHRpb25zIiwiY3JlYXRlIiwiaW50ZXJjZXB0b3JzIiwidXNlIiwicmVzcG9uc2UiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJwb3BQcm9taXNlIiwiaXgiLCJsZW5ndGgiLCJyZXEiLCJzcGxpY2UiLCJzaGlmdCIsInBvcFJlcXVlc3QiLCJpbmRleE9mIiwicG9wUXVldWVJdGVtIiwicXVldWVJdGVtIiwibW9ja1Jlc3BvbnNlIiwic2lsZW50TW9kZSIsIk9iamVjdCIsImFzc2lnbiIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJFcnJvciIsInJlc29sdmUiLCJtb2NrUmVzcG9uc2VGb3IiLCJjcml0ZXJpYSIsImdldFJlcU1hdGNoaW5nIiwibW9ja0Vycm9yIiwiZXJyb3IiLCJyZWplY3QiLCJsYXN0UmVxR2V0IiwibGFzdFByb21pc2VHZXQiLCJfY2hlY2tDcml0ZXJpYSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzbGljZSIsInJldmVyc2UiLCJmaW5kIiwieCIsImdldFJlcUJ5VXJsIiwicmVzZXQiLCJtb2NrQ2xlYXIiLCJDYW5jZWwiLCJDYW5jZWxUb2tlbiIsImlzQ2FuY2VsIiwidSIsIl9fQ0FOQ0VMX18iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFRQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7OztBQVFBO0FBQ0EsSUFBTUEsaUJBQXVDLEdBQUcsRUFBaEQ7O0FBRUEsSUFB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Q3JDLFNBQU9RLFNBQVMsQ0FBQ3lDLGNBQVYsQ0FBeUI7QUFBQ2pELElBQUFBLEdBQUcsRUFBSEE7QUFBRCxHQUF6QixDQUFQO0FBQ0gsQ0FGRDs7QUFJQVEsU0FBUyxDQUFDdUQsS0FBVixHQUFrQixZQUFNO0FBQ3BCO0FBQ0FuRSxFQUFBQSxpQkFBaUIsQ0FBQ3FDLE1BQWxCLENBQXlCLENBQXpCLEVBQTRCckMsaUJBQWlCLENBQUNtQyxNQUE5QyxFQUZvQixDQUlwQjs7O0FBQ0F2QixFQUFBQSxTQUFTLENBQUNHLEdBQVYsQ0FBY3FELFNBQWQ7QUFDQXhELEVBQUFBLFNBQVMsQ0FBQ0ssSUFBVixDQUFlbUQsU0FBZjtBQUNBeEQsRUFBQUEsU0FBUyxDQUFDTSxHQUFWLENBQWNrRCxTQUFkO0FBQ0F4RCxFQUFBQSxTQUFTLENBQUNPLEtBQVYsQ0FBZ0JpRCxTQUFoQjtBQUNBeEQsRUFBQUEsU0FBUyxVQUFULENBQWlCd0QsU0FBakI7QUFDQXhELEVBQUFBLFNBQVMsQ0FBQ1ksSUFBVixDQUFlNEMsU0FBZjtBQUNBeEQsRUFBQUEsU0FBUyxDQUFDYSxPQUFWLENBQWtCMkMsU0FBbEI7QUFDQXhELEVBQUFBLFNBQVMsQ0FBQ1EsT0FBVixDQUFrQmdELFNBQWxCO0FBQ0F4RCxFQUFBQSxTQUFTLENBQUNTLEdBQVYsQ0FBYytDLFNBQWQ7QUFDSCxDQWREOztBQWdCQXhELFNBQVMsQ0FBQ3lELE1BQVYsR0FBbUJBLGtCQUFuQjtBQUNBekQsU0FBUyxDQUFDMEQsV0FBVixHQUF3QkEsdUJBQXhCOztBQUNBMUQsU0FBUyxDQUFDMkQsUUFBVixHQUFxQixVQUFDQyxDQUFELEVBQW9CO0FBQ3JDLFNBQU8sQ0FBQyxFQUFFQSxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsVUFBVCxDQUFSO0FBQ0gsQ0FGRCxDLENBSUE7OztlQUNlN0QsUyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVHlwZVNjcmlwdCB2ZXJzaW9uIG9mIEF4aW9zIG1vY2sgZm9yIHVuaXQgdGVzdGluZyB3aXRoIFtKZXN0XShodHRwczovL2ZhY2Vib29rLmdpdGh1Yi5pby9qZXN0LykuXG4gKiBUaGlzIGZpbGUgaXMgYmFzZWQgb24gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vdHV4NC8zNjAwNmExODU5MzIzZjc3OWFiMFxuICpcbiAqIEBhdXRob3IgICBrbmVlLWNvbGEgPG5pa29sYS5kZXJlemljQGdtYWlsLmNvbT5cbiAqIEBsaWNlbnNlICBAbGljZW5zZSBNSVQgTGljZW5zZSwgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAqL1xuXG5pbXBvcnQgeyBTeW5jaHJvbm91c1Byb21pc2UsIFVucmVzb2x2ZWRTeW5jaHJvbm91c1Byb21pc2UgfSBmcm9tIFwic3luY2hyb25vdXMtcHJvbWlzZVwiO1xuaW1wb3J0IENhbmNlbCBmcm9tIFwiLi9jYW5jZWwvQ2FuY2VsXCI7XG5pbXBvcnQgQ2FuY2VsVG9rZW4gZnJvbSBcIi4vY2FuY2VsL0NhbmNlbFRva2VuXCI7XG5pbXBvcnQge1xuICAgIEF4aW9zTW9ja1F1ZXVlSXRlbSxcbiAgICBBeGlvc01vY2tSZXF1ZXN0Q3JpdGVyaWEsXG4gICAgQXhpb3NNb2NrVHlwZSxcbiAgICBIdHRwUmVzcG9uc2UsXG59IGZyb20gXCIuL21vY2stYXhpb3MtdHlwZXNcIjtcblxuLyoqIGEgRklGTyBxdWV1ZSBvZiBwZW5kaW5nIHJlcXVlc3QgKi9cbmNvbnN0IF9wZW5kaW5nX3JlcXVlc3RzOiBBeGlvc01vY2tRdWV1ZUl0ZW1bXSA9IFtdO1xuXG5jb25zdCBfbmV3UmVxOiAoY29uZmlnPzogYW55KSA9PiBVbnJlc29sdmVkU3luY2hyb25vdXNQcm9taXNlPGFueT4gPSAoY29uZmlnOiBhbnkgPSB7fSkgPT4ge1xuICAgIGNvbnN0IG1ldGhvZDogc3RyaW5nID0gY29uZmlnLm1ldGhvZDtcbiAgICBjb25zdCB1cmw6IHN0cmluZyA9IGNvbmZpZy51cmw7XG4gICAgY29uc3QgZGF0YTogYW55ID0gY29uZmlnLmRhdGE7XG4gICAgY29uc3QgcHJvbWlzZTogVW5yZXNvbHZlZFN5bmNocm9ub3VzUHJvbWlzZTxhbnk+ID0gU3luY2hyb25vdXNQcm9taXNlLnVucmVzb2x2ZWQoKTtcbiAgICBfcGVuZGluZ19yZXF1ZXN0cy5wdXNoKHtcbiAgICAgICAgY29uZmlnLFxuICAgICAgICBkYXRhLFxuICAgICAgICBtZXRob2QsXG4gICAgICAgIHByb21pc2UsXG4gICAgICAgIHVybCxcbiAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbmNvbnN0IF9oZWxwZXJSZXEgPSAobWV0aG9kOiBzdHJpbmcsIHVybDogc3RyaW5nLCBkYXRhPzogYW55LCBjb25maWc/OiBhbnkpID0+IHtcbiAgICBjb25zdCBjb25mID0gZGF0YSAmJiBjb25maWcgPyBjb25maWcgOiB7fTtcbiAgICByZXR1cm4gX25ld1JlcSh7XG4gICAgICAgIC4uLmNvbmYsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIG1ldGhvZCxcbiAgICAgICAgdXJsLFxuICAgIH0pO1xufTtcblxuY29uc3QgTW9ja0F4aW9zOiBBeGlvc01vY2tUeXBlID0gKGplc3QuZm4oX25ld1JlcSkgYXMgdW5rbm93bikgYXMgQXhpb3NNb2NrVHlwZTtcblxuLy8gbW9ja2luZyBBeGlvcyBtZXRob2RzXG5Nb2NrQXhpb3MuZ2V0ID0gamVzdC5mbihfaGVscGVyUmVxLmJpbmQobnVsbCwgXCJnZXRcIikpO1xuTW9ja0F4aW9zLnBvc3QgPSBqZXN0LmZuKF9oZWxwZXJSZXEuYmluZChudWxsLCBcInBvc3RcIikpO1xuTW9ja0F4aW9zLnB1dCA9IGplc3QuZm4oX2hlbHBlclJlcS5iaW5kKG51bGwsIFwicHV0XCIpKTtcbk1vY2tBeGlvcy5wYXRjaCA9IGplc3QuZm4oX2hlbHBlclJlcS5iaW5kKG51bGwsIFwicGF0Y2hcIikpO1xuTW9ja0F4aW9zLmRlbGV0ZSA9IGplc3QuZm4oX2hlbHBlclJlcS5iaW5kKG51bGwsIFwiZGVsZXRlXCIpKTtcbk1vY2tBeGlvcy5yZXF1ZXN0ID0gamVzdC5mbihfbmV3UmVxKTtcbk1vY2tBeGlvcy5hbGwgPSBqZXN0LmZuKCh2YWx1ZXMpID0+IFByb21pc2UuYWxsKHZhbHVlcykpO1xuTW9ja0F4aW9zLmhlYWQgPSBqZXN0LmZuKF9oZWxwZXJSZXEuYmluZChudWxsLCBcImhlYWRcIikpO1xuTW9ja0F4aW9zLm9wdGlvbnMgPSBqZXN0LmZuKF9oZWxwZXJSZXEuYmluZChudWxsLCBcIm9wdGlvbnNcIikpO1xuTW9ja0F4aW9zLmNyZWF0ZSA9IGplc3QuZm4oKCkgPT4gTW9ja0F4aW9zKTtcblxuTW9ja0F4aW9zLmludGVyY2VwdG9ycyA9IHtcbiAgICByZXF1ZXN0OiB7XG4gICAgICAgIHVzZTogamVzdC5mbigpLFxuICAgIH0sXG4gICAgcmVzcG9uc2U6IHtcbiAgICAgICAgdXNlOiBqZXN0LmZuKCksXG4gICAgfSxcbn07XG5cbk1vY2tBeGlvcy5kZWZhdWx0cyA9IHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAgIGNvbW1vbjogW10sXG4gICAgfSxcbn07XG5cbk1vY2tBeGlvcy5wb3BQcm9taXNlID0gKHByb21pc2U/OiBTeW5jaHJvbm91c1Byb21pc2U8YW55PikgPT4ge1xuICAgIGlmIChwcm9taXNlKSB7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgcHJvbWlzZSBmcm9tIHBlbmRpbmcgcXVldWVcbiAgICAgICAgZm9yIChsZXQgaXggPSAwOyBpeCA8IF9wZW5kaW5nX3JlcXVlc3RzLmxlbmd0aDsgaXgrKykge1xuICAgICAgICAgICAgY29uc3QgcmVxOiBBeGlvc01vY2tRdWV1ZUl0ZW0gPSBfcGVuZGluZ19yZXF1ZXN0c1tpeF07XG5cbiAgICAgICAgICAgIGlmIChyZXEucHJvbWlzZSA9PT0gcHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIF9wZW5kaW5nX3JlcXVlc3RzLnNwbGljZShpeCwgMSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcS5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdGFrZSB0aGUgb2xkZXN0IHByb21pc2VcbiAgICAgICAgY29uc3QgcmVxOiBBeGlvc01vY2tRdWV1ZUl0ZW0gPSBfcGVuZGluZ19yZXF1ZXN0cy5zaGlmdCgpO1xuICAgICAgICByZXR1cm4gcmVxID8gcmVxLnByb21pc2UgOiB2b2lkIDA7XG4gICAgfVxufTtcblxuTW9ja0F4aW9zLnBvcFJlcXVlc3QgPSAocmVxdWVzdD86IEF4aW9zTW9ja1F1ZXVlSXRlbSkgPT4ge1xuICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgIGNvbnN0IGl4ID0gX3BlbmRpbmdfcmVxdWVzdHMuaW5kZXhPZihyZXF1ZXN0KTtcbiAgICAgICAgaWYgKGl4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICAgICAgfVxuXG4gICAgICAgIF9wZW5kaW5nX3JlcXVlc3RzLnNwbGljZShpeCwgMSk7XG4gICAgICAgIHJldHVybiByZXF1ZXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfcGVuZGluZ19yZXF1ZXN0cy5zaGlmdCgpO1xuICAgIH1cbn07XG5cbi8qKlxuICogUmVtb3ZlcyBhbiBpdGVtIGZvcm0gdGhlIHF1ZXVlLCBiYXNlZCBvbiBpdCdzIHR5cGVcbiAqIEBwYXJhbSBxdWV1ZUl0ZW1cbiAqL1xuY29uc3QgcG9wUXVldWVJdGVtID0gKHF1ZXVlSXRlbTogU3luY2hyb25vdXNQcm9taXNlPGFueT4gfCBBeGlvc01vY2tRdWV1ZUl0ZW0gPSBudWxsKSA9PiB7XG4gICAgLy8gZmlyc3QgbGV0J3MgcHJldGVuZCB0aGUgcGFyYW0gaXMgYSBxdWV1ZSBpdGVtXG4gICAgY29uc3QgcmVxdWVzdDogQXhpb3NNb2NrUXVldWVJdGVtID0gTW9ja0F4aW9zLnBvcFJlcXVlc3QoXG4gICAgICAgIHF1ZXVlSXRlbSBhcyBBeGlvc01vY2tRdWV1ZUl0ZW0sXG4gICAgKTtcblxuICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgIC8vIElGIHRoZSByZXF1ZXN0IHdhcyBmb3VuZFxuICAgICAgICAvLyA+IHNldCB0aGUgcHJvbWlzZVxuICAgICAgICByZXR1cm4gcmVxdWVzdC5wcm9taXNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEVMU0UgbWF5YmUgdGhlIGBxdWV1ZUl0ZW1gIGlzIGEgcHJvbWlzZSAobGVnYWN5IG1vZGUpXG4gICAgICAgIHJldHVybiBNb2NrQXhpb3MucG9wUHJvbWlzZShxdWV1ZUl0ZW0gYXMgVW5yZXNvbHZlZFN5bmNocm9ub3VzUHJvbWlzZTxhbnk+KTtcbiAgICB9XG59O1xuXG5Nb2NrQXhpb3MubW9ja1Jlc3BvbnNlID0gKFxuICAgIHJlc3BvbnNlPzogSHR0cFJlc3BvbnNlLFxuICAgIHF1ZXVlSXRlbTogU3luY2hyb25vdXNQcm9taXNlPGFueT4gfCBBeGlvc01vY2tRdWV1ZUl0ZW0gPSBudWxsLFxuICAgIHNpbGVudE1vZGU6IGJvb2xlYW4gPSBmYWxzZSxcbik6IHZvaWQgPT4ge1xuICAgIC8vIHJlcGxhY2luZyBtaXNzaW5nIGRhdGEgd2l0aCBkZWZhdWx0IHZhbHVlc1xuICAgIHJlc3BvbnNlID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAge1xuICAgICAgICAgICAgY29uZmlnOiB7fSxcbiAgICAgICAgICAgIGRhdGE6IHt9LFxuICAgICAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgIHN0YXR1c1RleHQ6IFwiT0tcIixcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgKTtcblxuICAgIGNvbnN0IHByb21pc2UgPSBwb3BRdWV1ZUl0ZW0ocXVldWVJdGVtKTtcblxuICAgIGlmICghcHJvbWlzZSAmJiAhc2lsZW50TW9kZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyByZXF1ZXN0IHRvIHJlc3BvbmQgdG8hXCIpO1xuICAgIH0gZWxzZSBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIHJlc29sdmluZyB0aGUgUHJvbWlzZSB3aXRoIHRoZSBnaXZlbiByZXNwb25zZSBkYXRhXG4gICAgcHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcbn07XG5cbk1vY2tBeGlvcy5tb2NrUmVzcG9uc2VGb3IgPSAoXG4gICAgY3JpdGVyaWE6IHN0cmluZyB8IEF4aW9zTW9ja1JlcXVlc3RDcml0ZXJpYSxcbiAgICByZXNwb25zZT86IEh0dHBSZXNwb25zZSxcbiAgICBzaWxlbnRNb2RlOiBib29sZWFuID0gZmFsc2UsXG4pOiB2b2lkID0+IHtcbiAgICBpZiAodHlwZW9mIGNyaXRlcmlhID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNyaXRlcmlhID0ge3VybDogY3JpdGVyaWF9O1xuICAgIH1cbiAgICBjb25zdCBxdWV1ZUl0ZW0gPSBNb2NrQXhpb3MuZ2V0UmVxTWF0Y2hpbmcoY3JpdGVyaWEpO1xuXG4gICAgaWYgKCFxdWV1ZUl0ZW0gJiYgIXNpbGVudE1vZGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcmVxdWVzdCB0byByZXNwb25kIHRvIVwiKTtcbiAgICB9IGVsc2UgaWYgKCFxdWV1ZUl0ZW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIE1vY2tBeGlvcy5tb2NrUmVzcG9uc2UocmVzcG9uc2UsIHF1ZXVlSXRlbSwgc2lsZW50TW9kZSk7XG59O1xuXG5Nb2NrQXhpb3MubW9ja0Vycm9yID0gKFxuICAgIGVycm9yOiBhbnkgPSB7fSxcbiAgICBxdWV1ZUl0ZW06IFN5bmNocm9ub3VzUHJvbWlzZTxhbnk+IHwgQXhpb3NNb2NrUXVldWVJdGVtID0gbnVsbCxcbiAgICBzaWxlbnRNb2RlOiBib29sZWFuID0gZmFsc2UsXG4pID0+IHtcbiAgICBjb25zdCBwcm9taXNlID0gcG9wUXVldWVJdGVtKHF1ZXVlSXRlbSk7XG5cbiAgICBpZiAoIXByb21pc2UgJiYgIXNpbGVudE1vZGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcmVxdWVzdCB0byByZXNwb25kIHRvIVwiKTtcbiAgICB9IGVsc2UgaWYgKCFwcm9taXNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyByZXNvbHZpbmcgdGhlIFByb21pc2Ugd2l0aCB0aGUgZ2l2ZW4gcmVzcG9uc2UgZGF0YVxuICAgIHByb21pc2UucmVqZWN0KGVycm9yKTtcbn07XG5cbk1vY2tBeGlvcy5sYXN0UmVxR2V0ID0gKCkgPT4ge1xuICAgIHJldHVybiBfcGVuZGluZ19yZXF1ZXN0c1tfcGVuZGluZ19yZXF1ZXN0cy5sZW5ndGggLSAxXTtcbn07XG5cbk1vY2tBeGlvcy5sYXN0UHJvbWlzZUdldCA9ICgpID0+IHtcbiAgICBjb25zdCByZXEgPSBNb2NrQXhpb3MubGFzdFJlcUdldCgpO1xuICAgIHJldHVybiByZXEgPyByZXEucHJvbWlzZSA6IHZvaWQgMDtcbn07XG5cbmNvbnN0IF9jaGVja0NyaXRlcmlhID0gKGl0ZW06IEF4aW9zTW9ja1F1ZXVlSXRlbSwgY3JpdGVyaWE6IEF4aW9zTW9ja1JlcXVlc3RDcml0ZXJpYSkgPT4ge1xuICAgIGlmIChjcml0ZXJpYS5tZXRob2QgIT09IHVuZGVmaW5lZCAmJiBjcml0ZXJpYS5tZXRob2QgIT09IGl0ZW0ubWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoY3JpdGVyaWEudXJsICE9PSB1bmRlZmluZWQgJiYgY3JpdGVyaWEudXJsICE9PSBpdGVtLnVybCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5Nb2NrQXhpb3MuZ2V0UmVxTWF0Y2hpbmcgPSAoY3JpdGVyaWE6IEF4aW9zTW9ja1JlcXVlc3RDcml0ZXJpYSkgPT4ge1xuICAgIHJldHVybiBfcGVuZGluZ19yZXF1ZXN0c1xuICAgICAgICAuc2xpY2UoKVxuICAgICAgICAucmV2ZXJzZSgpIC8vIHJldmVyc2UgY2xvbmVkIGFycmF5IHRvIHJldHVybiBtb3N0IHJlY2VudCByZXFcbiAgICAgICAgLmZpbmQoKHg6IEF4aW9zTW9ja1F1ZXVlSXRlbSkgPT4gX2NoZWNrQ3JpdGVyaWEoeCwgY3JpdGVyaWEpKTtcbn07XG5cbk1vY2tBeGlvcy5nZXRSZXFCeVVybCA9ICh1cmw6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBNb2NrQXhpb3MuZ2V0UmVxTWF0Y2hpbmcoe3VybH0pO1xufTtcblxuTW9ja0F4aW9zLnJlc2V0ID0gKCkgPT4ge1xuICAgIC8vIHJlbW92ZSBhbGwgdGhlIHJlcXVlc3RzXG4gICAgX3BlbmRpbmdfcmVxdWVzdHMuc3BsaWNlKDAsIF9wZW5kaW5nX3JlcXVlc3RzLmxlbmd0aCk7XG5cbiAgICAvLyByZXNldHMgYWxsIGluZm9ybWF0aW9uIHN0b3JlZCBpbiB0aGUgbW9ja0ZuLm1vY2suY2FsbHMgYW5kIG1vY2tGbi5tb2NrLmluc3RhbmNlcyBhcnJheXNcbiAgICBNb2NrQXhpb3MuZ2V0Lm1vY2tDbGVhcigpO1xuICAgIE1vY2tBeGlvcy5wb3N0Lm1vY2tDbGVhcigpO1xuICAgIE1vY2tBeGlvcy5wdXQubW9ja0NsZWFyKCk7XG4gICAgTW9ja0F4aW9zLnBhdGNoLm1vY2tDbGVhcigpO1xuICAgIE1vY2tBeGlvcy5kZWxldGUubW9ja0NsZWFyKCk7XG4gICAgTW9ja0F4aW9zLmhlYWQubW9ja0NsZWFyKCk7XG4gICAgTW9ja0F4aW9zLm9wdGlvbnMubW9ja0NsZWFyKCk7XG4gICAgTW9ja0F4aW9zLnJlcXVlc3QubW9ja0NsZWFyKCk7XG4gICAgTW9ja0F4aW9zLmFsbC5tb2NrQ2xlYXIoKTtcbn07XG5cbk1vY2tBeGlvcy5DYW5jZWwgPSBDYW5jZWw7XG5Nb2NrQXhpb3MuQ2FuY2VsVG9rZW4gPSBDYW5jZWxUb2tlbjtcbk1vY2tBeGlvcy5pc0NhbmNlbCA9ICh1KTogdSBpcyBDYW5jZWwgPT4ge1xuICAgIHJldHVybiAhISh1ICYmIHUuX19DQU5DRUxfXyk7XG59O1xuXG4vLyB0aGlzIGlzIGEgc2luZ2xldG9uIG9iamVjdFxuZXhwb3J0IGRlZmF1bHQgTW9ja0F4aW9zO1xuIl19